<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta content="en-us" http-equiv="Content-Language">

	<title>Airbnb listings venice</title>
	<meta name="author" content="Guenter Richter" />
	<meta name="description" content="ixmaps iteractive map to explore airbnb listigs in venice,italy" />
	<meta name="keywords" content="ixmaps,airbnb,inside,listings,map,char,interactice,SVG" />
	<meta name="Resource-type" content="Document" />

	<!-- BOOTSTRAP CORE STYLE CSS -->
	<link href="assets/css/bootstrap.css" rel="stylesheet" />
	<!-- GOOGLE FONT -->
	<link href='https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic' rel='stylesheet' type='text/css'>
	<link href='https://fonts.googleapis.com/css?family=Raleway:400,300,700' rel='stylesheet' type='text/css'>


	<link href="assets/css/icomoon.css" rel="stylesheet" />
	<link href="assets/css/main.css" rel="stylesheet" />
	<link href="./inline_legend.css" rel="stylesheet" />

	<link rel="stylesheet" type="text/css" href="assets/css/jquery.fullPage.css" />
	<style type="text/css">
		.container {
			margin-left: 1em;
		}
		.title {
			margin-top: 3em;
			margin-bottom: 0em;
		}
		/* Overwriting fullPage.js tooltip color
		* --------------------------------------- */

		.fp-tooltip {
			color: #AAA;
		}

		#fp-nav span,
		.fp-slidesNav span {
			border-color: #AAA;
		}

		#fp-nav li .active span,
		.fp-slidesNav .active span {
			background: #AAA;
		}

		.shareIcon {
			font-size: 32px;
		}

		.active a {
			color: white;
		}

		body {
			-webkit-user-select: none;
			/* Chrome all / Safari all */
			-moz-user-select: none;
			/* Firefox all */
			-ms-user-select: none;
			/* IE 10+ */
			user-select: none;
			/* Likely future */
		}
		
		h3 {
			margin-right: 2em;
		}
	</style>

	<!--[if IE]>
		<script type="text/javascript">
			 var console = { log: function() {} };
		</script>
	<![endif]-->

</head>

<body style="background:none">

	<div id="fullpage" style="margin-top:0px;font-weight:500;display:none">

		<div class="section">

			<!-- città colorata -->

			<div class="slide container" style="color:#BB012A">
				<div class="intro down">
					<h3 class="title"><b>Palermo - Città Colorata</b></h3>
					<p>.
						<a class="theme button" href='javascript:mymap.loadProject("https://gjrichter.github.io/viz/Palermo/projects/ixmaps_project_palermo_stranieri_per_cittadinanza_fiori_watercolor_III.json");' style='display:none'>dummy</a><br>
					</p>
					<p>fonte: Città di Palermo, GB Vitrano, A Borruso </p>
					<p><b>scrolla giù</b> per altri visualizzazioni</p>
				</div>
			</div>

		</div>

		<div class="section">

			<!-- pile -->

			<div class="slide container" style="color:#BB012A">
				<div class="intro up down">
					<h3 class="title"><b>Cambiamo la grafica per poter aggiungere i residenti italiani...</b></h3>
					<p>
						<a class="theme button" href='javascript:mymap.loadProject("https://gjrichter.github.io/viz/Palermo/projects/ixmaps_project_palermo_stranieri_per_cittadinanza_fiori_watercolor_III_pile.json");' style='display:none'>dummy</a><br>
					</p>
				</div>
			</div>


		</div>

		<div class="section">

			<!-- l'invasione -->

			<div class="slide container" style="color:#BB012A">
				<div class="intro up down">
					<h3 class="title"><b>... abbiamo aggiunto i residenti italiani</b></h3>
					<h3>Ma questo non è una rappresentazione corretta, perche la grandezza delle palline non corrispontìde ai numeri</h3><h3>vediamo come è la relazione esatta ...</h3>
					<p>
						<a class="theme button" href='javascript:mymap.loadProject("https://gjrichter.github.io/viz/Palermo/projects/ixmaps_project_palermo_stranieri_per_cittadinanza_fiori_watercolor_III_log.json");' style='display:none'>dummy</a><br>
					</p>
				</div>
			</div>


		</div>

		<div class="section">

			<!-- l'invasione -->

			<div class="slide container" style="color:#DEA314">
				<div class="intro up down">
					<h3 class="title"><b>Ecco, la popolazione straniera a confronto con i rsidenti italiani</b></h3>
					<p>
						<a class="theme" href='javascript:mymap.loadProject("https://gjrichter.github.io/viz/Palermo/projects/ixmaps_project_palermo_stranieri_per_cittadinanza_fiori_watercolor_III_all.json");' style='display:none'>num_totale</a><br>
					</p>
				</div>
			</div>


		</div>

		<div class="section  intro up" style="color:#ffffff">
			<div class="container" id="contact" name="contact">
				<div class="row">
					<div class="col-lg-8 blog-content">

						<h3 class="title">Attribuzioni</h3>
						<p>Fonte: Città di Palermo, gbvitrano, aborruso</p>
						<p>Link ai dati: <a href='https://data.world/gbvitrano/popolazione-residente-a-palermo-upl/workspace/file?filename=Dati+%40aborruso.csv' target='_blank'>Data.world: Popolazione residente a Palermo - 2018 - UPL - official data</a>
						</p>

					</div>
				</div><!-- row -->

			</div><!-- container -->
		</div>

	</div>

	<div id="header" style="position: fixed;top:0;left:0px;width:90%;height:40px;">
		<div class="container" style="margin-top:11px">
			<div class="row">
				<div class="col-lg-8 col-lg-offset-2">
					<div class="header" aria-hidden="true">
						<div class="linkSocialContainer" style="float:left">
							<span class="linkContainer"></span>
							<span class="shareBtns" style="font-size:24px">
								<a href="javascript:ixmaps.popupShare()">
									<i class="shareIcon blackHover share_bitly icon-share" title="Share a short link" tabindex="-1"></i></a>
								<a href="javascript:__aboutDialog()">
									<i class="shareIcon blackHover share_bitly icon-info" title="Info" tabindex="-1" style="margin-left:0.2em"></i></a>
							</span>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- ==== MODAL DIALOG ==== -->
	<div id="modal-dialog-1" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" style="background:white;z-index:9999">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				...
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
	<div id="modal-dialog-2" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" style="background:white;z-index:9999">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				...
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>

	<script type="text/javascript" src="assets/plugins/jquery-1.10.2.js"></script>
	<script type="text/javascript" src="assets/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="assets/js/main.js"></script>
	<script type="text/javascript" src="assets/js/masonry.pkgd.min.js"></script>
	<script type="text/javascript" src="assets/js/imagesloaded.js"></script>
	<script type="text/javascript" src="assets/js/classie.js"></script>
	<script type="text/javascript" src="assets/js/AnimOnScroll.js"></script>

	<script type="text/javascript" src="assets/plugins/jquery.fullPage.min.js"></script>
	<script type="text/javascript" src="themes.js"></script>

	<script type="text/javascript">
		var mymap = null;
		// --------------------------------
		// get ixmaps API from parent 
		// --------------------------------

		var ixmaps = null;
		if (window.opener) {
			ixmaps = window.opener.ixmaps;
		} else
		if (parent) {
			ixmaps = parent.window.ixmaps;
		} else {
			alert("error: missing parent window for themes !");
		}

		ixmaps.initialized = false;

		// don't synchronise multiple map frames
		ixmaps.setSyncMultiMaps(false);

		var nLegendDiv = 0;
		var legendA = Array(0);
		ixmaps.setLegendDiv = function(n) {
			nLegendDiv = n;
		};

		ixmaps.setLoading = function() {
			ixmaps.showLoading("... caricando ...");
		};

		// define some helper for the sidebar menu

		ixmaps.moveSectionsDown = function(nr) {
			nr = nr || 1;
			for (var i = 0; i < nr; i++) {
				setTimeout("$.fn.fullpage.moveSectionDown();", i * 100);
			}
		};

		ixmaps.moveToSection = function(nr, slide) {
			ixmaps.fMoveToSection = true;
			$.fn.fullpage.silentMoveTo(nr, slide);
		};

		ixmaps.moveSlideRight = function(nr) {
			nr = nr || 1;
			for (var i = 0; i < nr; i++) {
				setTimeout("$.fn.fullpage.moveSlideRight();", i * 100);
			}
		};

		// --------------------------------
		// p a g e 
		// --------------------------------

		// enumerate sections, slides and theme
		// and create the right id's for fullpage slide handling
		// -----------------------------------------------------
		var section = 0;
		$(".section").each(function() {
			$(this).attr("id", "section" + (++section));
			var slide = 0;
			$(this).find(".slide").each(function() {
				$(this).attr("id", "section" + section + "slide" + (++slide));
				$(this).find(".theme").each(function() {
					$(this).attr("id", "theme_" + section + "" + slide);
				});
			});
		});

		// CUSTOM SCROLL SCRIPT FUNCTION FOR NAVBAR
		$(function() {
			$('.scrollclass a').bind('click', function(event) { //just pass scrollclass in design and start scrolling
				var $anchor = $(this);
				$('html, body').stop().animate({
					scrollTop: $($anchor.attr('href')).offset().top
				}, 1000, 'easeInOutQuad');
				event.preventDefault();
			});
		});
		//ADD REMOVE PADDING CLASS ON SCROLL
		$(window).scroll(function() {
			if ($(document).scrollTop() > 40) {
				$(".navbar-fixed-top").addClass("navbar-pad-original");
			} else {
				$(".navbar-fixed-top").removeClass("navbar-pad-original");
			}
		});

		//var html = '<a href="javascript:$.fn.fullpage.moveSectionDown();"><div class="row scrollclass fp-controlArrow fp-down" style="left:' + (window.innerWidth / 2 - 33) + 'px;text-align:center;margin-top:-0.7em;margin-bottom:1em;"></div></a>';
		//$('.down').append(html);

		//var html = '<a href="javascript:$.fn.fullpage.moveSectionUp();"><div class="row scrollclass fp-controlArrow fp-up" style="left:' + (window.innerWidth / 2 - 33) + 'px;text-align:center;margin-top:-2.2em;margin-bottom:3em;margin-left:1em"></div></a>';
		//$('.up').append(html);

		var html = '<div class="row scrollclass" style="position:absolute;top:' + (window.innerHeight - 100) + 'px;left:' + (window.innerWidth - 30) + 'px;text-align:center;"><a href="javascript:$.fn.fullpage.moveSectionDown();"><span class="icon icon-arrow-down tip" data-tip="next" style="font-size:36px;color:#dddddd;"></span></a></div>';
		$('.down').append(html);

		var html = '<div class="row scrollclass" style="position:absolute;top:' + (18) + 'px;left:' + (window.innerWidth - 30) + 'px;text-align:center;"><a href="javascript:$.fn.fullpage.moveSectionUp();"><span class="icon icon-arrow-up tip" data-tip="next" style="font-size:36px;color:#dddddd;"></span></a></div>';
		$('.up').append(html);


		$(document).ready(function() {

			var __section = null;
			var __slide = null;
			var __fMoveActive = false;

			__onChange = function() {
				if (!ixmaps.initialized) {
					setTimeout("__onChange()",100);
					return;
				}
				if (ixmaps.fMoveToSection) {
					ixmaps.fMoveToSection = false;
					return;
				}
				__doTheme("theme_" + __section + (__slide + 1));
			};
			$('#fullpage').fullpage({
				'scrollOverflow': true,
				'scrollOverflowOptions': {
					scrollbars: false
				},
				'verticalCentered': false,
				'css3': true,
				'sectionsColor': ['#DEA314', '#DEA314','#DEA314', '#DD614A', '#DD614A', '#B14A4A'],
				'navigation': true,
				'navigationPosition': 'right',
				'navigationTooltips': ['Incidenti', 'Analisi temporali', 'Pericolosità', 'Natura del incidente', 'Attribuzioni'],

				'afterLoad': function(a, index, c, d) {
					__section = index;
					__slide = 0;
					$.fn.fullpage.silentMoveTo(index, __slide);
				},
				'afterSlideLoad': function(a, index, c, d) {
					__slide = d;
					__onChange();
				},

				'onLeave': function(index, nextIndex, direction) {}
			});
			$('#fullpage').fadeIn("slow");
		});

		__doThemeOldTheme = null;
		__doThemeTimeout = null;
		__doTheme = function(szName) {
			if (szName == __doThemeOldTheme) {
				return;
			}
			__doThemeOldTheme = szName;
			if (__doThemeTimeout) {
				clearTimeout(__doThemeTimeout);
			}
			__doThemeTimeout = setTimeout("__doThemeOnTimeout('" + szName + "')", 100);
		}
		__doThemeOnTimeout = function(szName) {
			$("#" + szName).click();
			eval($("#" + szName).attr("href"));
		}

		// ------------------------------
		// set resize handler
		// ------------------------------
		$(window).resize(function() {
			// refresh scrollspy !!!
			$('[data-spy="scroll"]').each(function() {
				var $spy = $(this).scrollspy('refresh')
			});
		});


		// --------------------------------------------------------------
		// define click extension to
		// check/highlight the theme button 
		// --------------------------------------------------------------

		// array to store the clicked objects for onRemoveTheme callback
		var clickA = new Array(0);

		// store the last clicked object for onNewTheme callback
		var lastClicked = null;
		$("a").click(function() {
			if (String($(this).attr("href")).match(/newtheme/i) || String($(this).attr("href")).match(/loadProject/i)) {
				lastClicked = $(this);
			}
		});

		// -----------------------------------
		// adapt legend background to map type
		// -----------------------------------

		/**
		 * set legend background on map type change
		 * @type void
		 */
		__changeCss = function(className, classValue) {

			var cssMainContainer = $('#css-modifier-container');
			if (cssMainContainer.length == 0) {
				var cssMainContainer = $('<style id="css-modifier-container"></style>');
				cssMainContainer.appendTo($('head'));
			}
			cssMainContainer.append(className + " {" + classValue + "}\n");
		};

		ixmaps.htmlgui_setMapTypeBG = function(szId) {

			$("#css-modifier-container").remove();

			if (szId.match(/dark/i) || szId.match(/black/i)) {
				__changeCss(".story-body", "background-color:rgba(25,25,25,0.3)");
				__changeCss(".inline-legend", "background-color:rgba(25,25,25,0.7)");
				__changeCss(".title", "background-color:rgba(25,25,25,0.7)");
			} else {
				__changeCss(".body-story", "background-color:rgba(255,255,255,0.1)");
				__changeCss(".inline-legend", "background-color:rgba(255,255,255,0.5)");
				__changeCss(".title", "background-color:rgba(255,255,255,0.5)");
			}
		};

		// -----------------------------------------------
		// load themes script
		// and initialize map if all loaded
		// -----------------------------------------------

		$.when(
			$.getScript("./index.js"),
			$.getScript("./inline_legend.js"),
			$.Deferred(function(deferred) {
				$(deferred.resolve);
			})
		).done(function() {

			// ------------------------------
			// initialize map
			// ------------------------------

			ixmaps.waitForMap(null, function(map) {

				ixmaps.initialized = true;

				map.setLocalString("... processing ...", "...");
				map.setLocalString("... creating theme ...", "...");
				map.setLocalString("cleaning up ...", "");
				map.setLocalString("loading data ...", "... caricando dati ...");

				mymap = map;
				//map.loadProject("../../../../../dev/rc/ixmaps/projects/Palermo/ixmaps_project_palermo_stranieri_per_cittadinanza_fiori_watercolor_III.json");

			});

		}).fail(function() {
			alert("script loading " + arguments[2].toString());
		});

		/**
		 * open/close the about dialog 
		 * @param flag 'show' or 'hide'
		 * @type void
		 */
		__aboutDialog = function(flag){
			var about = "../../stories/Palermo_Stranieri/about.html";
			if ( ixmaps.loadedProject.metadata.about && ixmaps.loadedProject.metadata.about.length ){
				about = ixmaps.loadedProject.metadata.about;
			}
			ixmaps.embeddedApi.embeddedApi.openDialog(null,'about-dialog',about,'about this map','200,50',600,600);
		};
		
	</script>


</body>

</html>
